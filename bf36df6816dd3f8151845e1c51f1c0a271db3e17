{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "d9e3ca62_a97f8ef0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 25
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-28T21:22:30Z",
      "side": 1,
      "message": "Looks pretty close, just error handling cleanup, then should be good.",
      "revId": "bf36df6816dd3f8151845e1c51f1c0a271db3e17",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "75ee57b1_434e4680",
        "filename": "src/FanMain.cpp",
        "patchSetId": 25
      },
      "lineNbr": 155,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-28T21:21:13Z",
      "side": 1,
      "message": "can you clean this logic up a little?  I suspect you\u0027ve put the if (ec) in the wrong scope, because you\u0027re still relying on the return value of fs::exists before you actually use the value.  I would expect this to look like\n\nstd::error_code ec;\nbool exists \u003d fs::exists(path, ec);\nif (ec || !exists){\n   return false;\n}\nreturn findPwmfanPath(pwm, pwmPath);",
      "range": {
        "startLine": 142,
        "startChar": 0,
        "endLine": 155,
        "endChar": 5
      },
      "revId": "bf36df6816dd3f8151845e1c51f1c0a271db3e17",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7aaa808_9aa8f3de",
        "filename": "src/FanMain.cpp",
        "patchSetId": 25
      },
      "lineNbr": 155,
      "author": {
        "id": 1001264
      },
      "writtenOn": "2022-04-29T06:47:35Z",
      "side": 1,
      "message": "Hi @Ed, thanks for the example.\n\nThere are two methods to find pwmX file,\n\n1. first method (original one), assume pwmX and fanX_input are locate at same folder.\n```\nauto path \u003d directory / (\"pwm\" + std::to_string(pwm + 1));\nif (fs::exists(path, ec)) {\n    if (!ec) {\n        pwmPath \u003d path;\n        return true;\n    }\n}\n```\n\n2. second method (device node declare with pwm-fan)\nWith pwm-fan driver, pwmX and fanX_input are no longer locate at same folder.\nThe pwmX file are separate into each pwn-fanX folder, it means we needs configured pwm index in EM to find corresponding pwn-fanX folder and pwmX file, and `findPwmfanPath()` is created for this purpose.\n\n\nI saw your example return false when path not exist or non-zero error code, but it was not my intension. My initial idea was to apply first method and see if the filepath exist or not, if the path doesn\u0027t exist or non-zero error code generated, then we try second method (findPwmfanPath).\n\nNot sure is it sound reasonable for you?",
      "parentUuid": "75ee57b1_434e4680",
      "range": {
        "startLine": 142,
        "startChar": 0,
        "endLine": 155,
        "endChar": 5
      },
      "revId": "bf36df6816dd3f8151845e1c51f1c0a271db3e17",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0906dac4_e6fc93bc",
        "filename": "src/FanMain.cpp",
        "patchSetId": 25
      },
      "lineNbr": 155,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-29T16:15:47Z",
      "side": 1,
      "message": "\u003e I saw your example return false when path not exist or non-zero error code,\n\nSure, it\u0027s possible I didn\u0027t get the logic quite right, the key is that you need to check the value of ec BEFORE you use the information available in \"exists\" above.\n\n\nstd::error_code ec;\nbool exists \u003d fs::exists(path, ec);\nif (!ec){\n    if (!exists){\n       return false;\n    }\n}\n\nreturn findPwmfanpath(...);\n\n\nI think that corrects the logic?",
      "parentUuid": "a7aaa808_9aa8f3de",
      "range": {
        "startLine": 142,
        "startChar": 0,
        "endLine": 155,
        "endChar": 5
      },
      "revId": "bf36df6816dd3f8151845e1c51f1c0a271db3e17",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1d1a76b9_43f116c6",
        "filename": "src/FanMain.cpp",
        "patchSetId": 25
      },
      "lineNbr": 155,
      "author": {
        "id": 1001264
      },
      "writtenOn": "2022-04-29T23:45:20Z",
      "side": 1,
      "message": "Hi @Ed,\n \nI update it as below, and also upload to patchset 27\n\n```\nstd::error_code ec;\nbool exists \u003d fs::exists(path, ec);\nif (ec || !exists) {\n    /* path not exists from first method\n     * or error code generated from fs::exists()\n     *\n     * try find path by second method findPwmfanpath()\n     */\n    return findPwmfanpath(...);\n}\n\n/* path exists without any error\n * assign path to pwmPath and return true\n */\npwmPath \u003d path\nreturn true;\n```",
      "parentUuid": "0906dac4_e6fc93bc",
      "range": {
        "startLine": 142,
        "startChar": 0,
        "endLine": 155,
        "endChar": 5
      },
      "revId": "bf36df6816dd3f8151845e1c51f1c0a271db3e17",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}