{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "2df31038_f38043e6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 15,
      "author": {
        "id": 1000936
      },
      "writtenOn": "2024-11-02T17:01:23Z",
      "side": 1,
      "message": "Can you please clarify whether you mean just RPM monitoring or also PWM control?\n\nThe driver referenced seems to be only allowing control via `/sys/class/pwmchip*/` interface by changing `duty_cycle` after exporting and setting `period`. I do not see any code anywhere that supports this new method and offers `xyz.openbmc_project.Control.FanPwm` D-Bus interface, can you please tell how to use it?",
      "revId": "40c4d6856ffefb5c1e8a8d4eac9b4889bc5854d1",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "befe15c4_b734d838",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 15,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-11-12T17:06:54Z",
      "side": 1,
      "message": "https://gist.github.com/williamspatrick/447bd11626f982734f9f7d83a2a571ec\n\nSeems to be working?",
      "parentUuid": "2df31038_f38043e6",
      "revId": "40c4d6856ffefb5c1e8a8d4eac9b4889bc5854d1",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1be0c4d5_a785c3c5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 15,
      "author": {
        "id": 1000936
      },
      "writtenOn": "2024-11-12T21:12:17Z",
      "side": 1,
      "message": "\u003e https://gist.github.com/williamspatrick/447bd11626f982734f9f7d83a2a571ec\n\u003e \n\u003e Seems to be working?\n\nPatrick, thank you for taking a look!\n\nCan you please confirm the kernel driver used is the one from current OpenBMC tree without any related patches? Asking because there\u0027s a difference between the old out of tree code: https://patchwork.ozlabs.org/project/openbmc/patch/20210113070850.1184506-5-troy_lee@aspeedtech.com/ (search for `aspeed_pwm_hwmon_info` which lists the additional /hwmon/ attributes) and the current driver at https://github.com/openbmc/linux/blob/dev-6.6/drivers/hwmon/aspeed-g6-pwm-tach.c#L268 which only offers /pwmchip/ sysfs interface to the userspace AFAICT.\n\nWith the old driver we had device nodes like `/sys/devices/platform/ahb/1e6e0000.apb/1e610000.pwm-tacho-controller/hwmon/hwmon0/pwm1` and that was handled nicely by dbus-sensors. But with the new driver (referenced from the commit message in the currently discussed patch) which eventually landed upstream the userspace would need to handle talking via `/sys/class/pwm/pwmchip0` and I do not see any code in dbus-sensors that can do that and it didn\u0027t work in our testing.",
      "parentUuid": "befe15c4_b734d838",
      "revId": "40c4d6856ffefb5c1e8a8d4eac9b4889bc5854d1",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "957ac98b_d4c647ca",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 15,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-11-12T21:33:50Z",
      "side": 1,
      "message": "The only out of tree patch we currently have is this dts tweak.  I\u0027m not sure why this didn\u0027t end up in the Aspeed driver set.\n\nhttps://github.com/facebook/openbmc/blob/f35004eb3953de22407ca411e342a329e491cc90/common/recipes-kernel/linux/6.6/0170-aspeed-g6.dtsi-update-for-PWM-and-TACH-driver.patch#L4",
      "parentUuid": "1be0c4d5_a785c3c5",
      "revId": "40c4d6856ffefb5c1e8a8d4eac9b4889bc5854d1",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "13554029_ac302095",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 15,
      "author": {
        "id": 1000936
      },
      "writtenOn": "2024-11-12T22:24:01Z",
      "side": 1,
      "message": "Sorry but I\u0027m still really puzzled here. See, dbus-sensors only looks for `pwm*` files in `/sys/class/hwmon/` https://github.com/openbmc/dbus-sensors/blob/master/src/fan/FanMain.cpp#L150 , https://github.com/openbmc/dbus-sensors/blob/master/src/fan/FanMain.cpp#L180 and does not create D-Bus objects if those files do not exist https://github.com/openbmc/dbus-sensors/blob/master/src/fan/FanMain.cpp#L592 . But they do not exist with the new driver so how is it at all possible? With the old driver symlink `ls -l /sys/devices/platform/ahb/1e6e0000.apb/*/driver` points to `aspeed_pwm_tachometer` and it creates the pwm* files in hwmon while the new driver is called `aspeed-g6-pwm-tach` and it does not for me.",
      "parentUuid": "957ac98b_d4c647ca",
      "revId": "40c4d6856ffefb5c1e8a8d4eac9b4889bc5854d1",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ],
  "submitRequirementResults": []
}